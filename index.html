<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>The Christian Gentlemen</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script src="papaparse.min.js"></script>
	<script src="Chart.min.js"></script>
	
	
	
</head>
<body>
	<div id="container">
		<input type="text" id="playerName" placeholder="Player Name"></input><br>
		<input type="button" id="search" value="Search"></input><input type="button" id="clear" value="Clear" onclick="clearPage()"></input>
		<p id="playerInfo"></p>
		
		<p>PA</p>
		<canvas id="paChart" width="1200" height="400"></canvas>
		
		<p>H</p>
		<canvas id="hChart" width="1200" height="400"></canvas>
		
		<p>DBL</p>
		<canvas id="dblChart" width="1200" height="400"></canvas>
		
		<p>TPL</p>
		<canvas id="tplChart" width="1200" height="400"></canvas>
		
		<p>HR</p>
		<canvas id="hrChart" width="1200" height="400"></canvas>
		
		<p>SO</p>
		<canvas id="soChart" width="1200" height="400"></canvas>
		
		<p>BB</p>
		<canvas id="bbChart" width="1200" height="400"></canvas>
		
		<p>SB</p>
		<canvas id="sbChart" width="1200" height="400"></canvas>
		
		<p>CS</p>
		<canvas id="csChart" width="1200" height="400"></canvas>
		
	</div>
<script>
var rosterCSV = "";
var statsCSV = "";
var hrctx;
var pactx;
var hctx;
var dblctx;
var tplctx;
var soctx;
var bbctx;
var sbctx;
var csctx;

var hrChart;
var paChart;
var hChart;
var dblChart;
var tplChart;
var soChart;
var bbChart;
var sbChart;
var csChart;

$("#search").click(function(){
	var stats;
	var proj;
	var oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds
	var firstDate = new Date(2015,04,3);
	var today = new Date();

	var dayOfSeason = Math.round(Math.abs((firstDate.getTime() - today.getTime())/(oneDay)));
	
    $.ajax({url: "DCBatters.csv", success: function(result){
        rosterCSV = result;
		console.log(rosterCSV);
		proj = parseData(rosterCSV);
				
    }});
	
	$.ajax({url: "SeasonStats.csv", success: function(result){
        statsCSV = result;
		console.log(statsCSV);
		stats = parseData(statsCSV);
				
    }});
	console.log(proj);
	console.log(stats);
	//HR
	var hrArrayProj = [];
	var hrArrayStats = [];
	
	var hrRateProj = proj.HR/26;
	var hrRateStats = stats.HR/dayOfSeason;
	
	var hrHolderProj = 0;
	var hrHolderStats = 0;
	
	var dayProj = [];
	
	for (j=0; j<181; j+=7){
		hrHolderProj = hrHolderProj + hrRateProj;
		hrArrayProj.push(Math.floor(hrHolderProj));
		week = j / 7;
		dayProj.push("Week:"+ week.toString());
	};
	for (jj=0; jj<dayOfSeason; jj+=7){
		hrHolderStats = hrHolderStats + hrRateStats;
		hrArrayStats.push(Math.floor(hrHolderStats));
	};
	var hrData = {
		labels: dayProj,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: hrArrayProj
		},
		{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#022840",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: hrArrayStats
		}]
	};
	var options = {
		bezierCurve: false
	};
	hrctx = $("#hrChart").get(0).getContext("2d");
	hrChart = new Chart(hrctx).Line(hrData, options);
	//PA
	var paArray = [];
	var paRate = player.PA/26;
	var paHolder = 0;
	var paDay = [];
	for (k=0; k<181; k+=7){
		paHolder = paHolder + paRate;
		paArray.push(Math.floor(paHolder));
		week = k / 7;
		paDay.push("Week:"+ week.toString());
	};
	var paData = {
		labels: day,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: paArray
		}]
	};
	
	pactx = $("#paChart").get(0).getContext("2d");
	paChart = new Chart(pactx).Line(paData, options);
	//H
	var hArray = [];
	var hRate = player.H/26;
	var hHolder = 0;
	var hDay = [];
	for (l=0; l<181; l+=7){
		hHolder = hHolder + hRate;
		hArray.push(Math.floor(hHolder));
		week = l / 7;
		hDay.push("Week:"+ week.toString());
	};
	var hData = {
		labels: hDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: hArray
		}]
	};

	hctx = $("#hChart").get(0).getContext("2d");
	hChart = new Chart(hctx).Line(hData, options);
	//DBL
	var dblArray = [];
	var dblRate = player.DBL/26;
	var dblHolder = 0;
	var dblDay = [];
	for (m=0; m<181; m+=7){
		dblHolder = dblHolder + dblRate;
		dblArray.push(Math.floor(dblHolder));
		week = m / 7;
		dblDay.push("Week:"+ week.toString());
	};
	var dblData = {
		labels: dblDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: dblArray
		}]
	};
	
	dblctx = $("#dblChart").get(0).getContext("2d");
	dblChart = new Chart(dblctx).Line(dblData, options);
	//TPL
	var tplArray = [];
	var tplRate = player.TPL/26;
	var tplHolder = 0;
	var tplDay = [];
	for (n=0; n<181; n+=7){
		tplHolder = tplHolder + tplRate;
		tplArray.push(Math.floor(tplHolder));
		week = n / 7;
		tplDay.push("Week:"+ week.toString());
	};
	var tplData = {
		labels: tplDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: tplArray
		}]
	};

	tplctx = $("#tplChart").get(0).getContext("2d");
	tplChart = new Chart(tplctx).Line(tplData, options);
	//SO
	var soArray = [];
	var soRate = player.SO/26;
	var soHolder = 0;
	var soDay = [];
	for (o=0; o<181; o+=7){
		soHolder = soHolder + soRate;
		soArray.push(Math.floor(soHolder));
		week = o / 7;
		soDay.push("Week:"+ week.toString());
	};
	var soData = {
		labels: soDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: soArray
		}]
	};

	soctx = $("#soChart").get(0).getContext("2d");
	soChart = new Chart(soctx).Line(soData, options);
	//BB
	var bbArray = [];
	var bbRate = player.BB/26;
	var bbHolder = 0;
	var bbDay = [];
	for (p=0; p<181; p+=7){
		bbHolder = bbHolder + bbRate;
		bbArray.push(Math.floor(bbHolder));
		week = p / 7;
		bbDay.push("Week:"+ week.toString());
	};
	var bbData = {
		labels: bbDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: bbArray
		}]
	};

	bbctx = $("#bbChart").get(0).getContext("2d");
	bbChart = new Chart(bbctx).Line(bbData, options);
	//SB
	var sbArray = [];
	var sbRate = player.SB/26;
	var sbHolder = 0;
	var sbDay = [];
	for (q=0; q<181; q+=7){
		sbHolder = sbHolder + sbRate;
		sbArray.push(Math.floor(sbHolder));
		week = q / 7;
		sbDay.push("Week:"+ week.toString());
	};
	var sbData = {
		labels: sbDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: sbArray
		}]
	};

	sbctx = $("#sbChart").get(0).getContext("2d");
	sbChart = new Chart(sbctx).Line(sbData, options);
	//CS
	var csArray = [];
	var csRate = player.CS/26;
	var csHolder = 0;
	var csDay = [];
	for (r=0; r<181; r+=7){
		csHolder = csHolder + csRate;
		csArray.push(Math.floor(csHolder));
		week = r / 7;
		csDay.push("Week:"+ week.toString());
	};
	var csData = {
		labels: csDay,
		datasets: [{
			label: "My First dataset",
            fillColor: "#dddddd",
            strokeColor: "#bbbbbb",
            pointColor: "rgba(220,220,220,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(220,220,220,1)",
            data: csArray
		}]
	};

	csctx = $("#csChart").get(0).getContext("2d");
	csChart = new Chart(csctx).Line(csData, options);
});

function clearPage(){
	hrChart.destroy();
	paChart.destroy();
	hChart.destroy();
	dblChart.destroy();
	tplChart.destroy();
	soChart.destroy();
	bbChart.destroy();
	sbChart.destroy();
	csChart.destroy();
	document.getElementById("playerName").value = "";
	document.getElementById("playerInfo").innerHTML = "";
}

function parseData(csv){
	var player;
	var pResult = Papa.parse(csv,{
					header: true
				  });
	var playerName = document.getElementById("playerName").value
	console.log(playerName);
	
		for (i=0;i<pResult.data.length;i++){
			if (pResult.data[i].Name === playerName){
				player = pResult.data[i];
			};
		};
	
	console.log(player);
	$("#playerInfo").text(player.Name + ", " + player.Team + ", PA:" + player.PA + ", H:" + player.H + ", 2B:" + player.DBL + ", 3B:" + player.TPL + ", HR:" + player.HR + ", SO:" + player.SO + ", BB:" + player.BB + ", SB:" + player.SB + ", CS:" + player.CS);
	
	return player;
}
</script>
</body>
</html>